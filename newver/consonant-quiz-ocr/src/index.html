<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>자음 퀴즈 - 화면 캡쳐 및 자동 답안 추출</title>
  <link rel="stylesheet" href="css/styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.11.0/dist/tf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4.0.2/dist/tesseract.min.js"></script>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>🎮 자음 퀴즈 자동 답안 추출기</h1>
      <button id="settingsBtn" class="settings-btn" title="학습 모드">⚙️</button>
    </div>
    
    <div class="mainWrap">
      <!-- 왼쪽: 컨트롤 영역 -->
      <div class="leftCol">
        <h3>📹 화면 캡쳐 컨트롤</h3>
        <div class="controls">
          <button id="startCaptureBtn" class="btn btn-primary">화면 캡쳐 시작</button>
          <button id="stopCaptureBtn" class="btn btn-danger" disabled>캡쳐 중지</button>
        </div>
        
        <div id="status" class="status-box">준비 상태</div>
        
        <div id="hint" class="hint-box">
          <strong>💡 사용 방법:</strong><br>
          1. '화면 캡쳐 시작' 버튼 클릭<br>
          2. 캡쳐할 화면/창 선택<br>
          3. 드래그로 퀴즈 영역 지정<br>
          4. 자동으로 정답 추출 및 표시
        </div>

        <div id="progressWrap">
          <div id="progress"><i></i></div>
        </div>

        <div id="log">로그 메시지가 여기에 표시됩니다.</div>
      </div>

      <!-- 오른쪽: 화면 프리뷰 및 결과 영역 -->
      <div class="rightCol">
        <h3>🖥️ 실시간 화면 프리뷰</h3>
        <div id="captureArea">
          <video id="screenVideo" autoplay muted></video>
          <canvas id="captureCanvas"></canvas>
          <div id="selectionBox" class="selection-box"></div>
        </div>

        <div id="ocrLive">
          <div id="ocrLiveText">실시간 OCR 결과...</div>
          <button id="copyOcrBtn" class="btn btn-small" style="display:none;">📋 복사</button>
        </div>

        <h3>✅ 검색된 정답 목록</h3>
        <div id="result" class="result-box">
          <p class="placeholder">정답이 여기에 표시됩니다.</p>
        </div>
        
        <div class="result-controls">
          <button id="copyResultBtn" class="btn btn-success" disabled>📋 모든 정답 복사</button>
          <button id="clearResultBtn" class="btn btn-secondary">🗑️ 결과 지우기</button>
        </div>
      </div>
    </div>

    <!-- 학습 모드 모달 -->
    <div id="trainModal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <h2>🎓 자음 학습 모드</h2>
        
        <!-- GitHub 인증 상태 -->
        <div id="authStatus" class="auth-status">
          <p>학습 데이터를 저장하려면 GitHub 로그인이 필요합니다.</p>
          <button id="githubLoginBtn" class="btn btn-primary">GitHub으로 로그인</button>
          <div id="userInfo" style="display:none;">
            <p>로그인: <strong id="username"></strong></p>
            <button id="githubLogoutBtn" class="btn btn-secondary">로그아웃</button>
          </div>
        </div>
        
        <div id="trainingArea" style="display:none;">
          <p>각 자음의 이미지 샘플을 제공하여 인식률을 향상시키세요.<br>
          학습 데이터는 자동으로 리포지토리에 저장되어 모든 사용자가 활용할 수 있습니다.</p>
          
          <div class="train-input">
            <label for="consonantSelect">학습할 자음 선택:</label>
            <select id="consonantSelect">
              <option value="">선택하세요</option>
              <option value="ㄱ">ㄱ</option>
              <option value="ㄴ">ㄴ</option>
              <option value="ㄷ">ㄷ</option>
              <option value="ㄹ">ㄹ</option>
              <option value="ㅁ">ㅁ</option>
              <option value="ㅂ">ㅂ</option>
              <option value="ㅅ">ㅅ</option>
              <option value="ㅇ">ㅇ</option>
              <option value="ㅈ">ㅈ</option>
              <option value="ㅊ">ㅊ</option>
              <option value="ㅋ">ㅋ</option>
              <option value="ㅌ">ㅌ</option>
              <option value="ㅍ">ㅍ</option>
              <option value="ㅎ">ㅎ</option>
              <option value="ㄲ">ㄲ</option>
              <option value="ㄸ">ㄸ</option>
              <option value="ㅃ">ㅃ</option>
              <option value="ㅆ">ㅆ</option>
              <option value="ㅉ">ㅉ</option>
            </select>
          </div>

          <div class="train-input">
            <label for="trainImageInput">이미지 업로드:</label>
            <input type="file" id="trainImageInput" accept="image/*" multiple />
          </div>

          <div id="trainPreview" class="train-preview"></div>

          <button id="startTrainBtn" class="btn btn-primary">학습 데이터 저장</button>
          <div id="trainStatus" class="train-status"></div>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="js/utils.js"></script>
  <script type="module" src="js/database.js"></script>
  <script type="module" src="js/ocr.js"></script>
  <script type="module" src="js/ui.js"></script>
  <script type="module" src="js/app.js"></script>
</body>
</html>